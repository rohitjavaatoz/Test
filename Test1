SELECT *
FROM pg_sequences
WHERE sequencename = 'ucmcmt.api_messages_api_message_id_seq';
----
CREATE SEQUENCE ucmcmt.email_messages_email_message_id_seq
    INCREMENT BY 1
    START WITH 1
    MINVALUE 1
    MAXVALUE 2147483647
    CACHE 1;
-------------------


CREATE SEQUENCE ucmcmt.api_messages_api_message_id_seq
    INCREMENT BY 1
    START WITH 1
    MINVALUE 1
    MAXVALUE 2147483647
    CACHE 1;
----------------------------
-- Table: ucmcmt.api_messages

-- DROP TABLE IF EXISTS ucmcmt.api_messages;

CREATE TABLE IF NOT EXISTS ucmcmt.api_messages
(
    api_message_id integer NOT NULL DEFAULT nextval('email_and_api_messages_id_seq'::regclass),
    message_id integer,
    api_payload json,
    party_id integer,
    created_date timestamp without time zone,
    created_by character varying COLLATE pg_catalog."default",
    modified_date timestamp without time zone,
    modified_by character varying COLLATE pg_catalog."default",
    api_message_status_id integer,
    parent_api_message_id integer,
    retry_request_creation_count integer,
    is_fiber boolean,
    CONSTRAINT api_message_id_pkey PRIMARY KEY (api_message_id)
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS ucmcmt.api_messages
    OWNER to ucmqa;
------
-- Table: ucmcmt.email_messages

-- DROP TABLE IF EXISTS ucmcmt.email_messages;

CREATE TABLE IF NOT EXISTS ucmcmt.email_messages
(
    email_message_id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    message_id integer NOT NULL,
    header_id character varying(200) COLLATE pg_catalog."default",
    subject text COLLATE pg_catalog."default",
    body_html text COLLATE pg_catalog."default",
    body_text text COLLATE pg_catalog."default",
    body_translated text COLLATE pg_catalog."default",
    language character varying(20) COLLATE pg_catalog."default",
    party_id integer,
    created_date timestamp without time zone,
    created_by character varying COLLATE pg_catalog."default",
    modified_date timestamp without time zone,
    modified_by character varying COLLATE pg_catalog."default",
    is_seen boolean,
    email_message_status_id integer,
    is_locked boolean,
    locked_by character varying(225) COLLATE pg_catalog."default",
    locked_at timestamp without time zone,
    parent_email_message_id integer,
    retry_request_creation_count integer,
    is_fiber boolean,
    CONSTRAINT email_messages_pkey PRIMARY KEY (email_message_id),
    CONSTRAINT email_message_status_fkkey FOREIGN KEY (email_message_status_id)
        REFERENCES ucmcmt.email_message_status (email_message_status_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT message_fk FOREIGN KEY (message_id)
        REFERENCES ucmcmt.messages (message_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT party_fk FOREIGN KEY (party_id)
        REFERENCES ucmcmt.party (key) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS ucmcmt.email_messages
    OWNER to ucm_app;

REVOKE ALL ON TABLE ucmcmt.email_messages FROM wuwe4gy;

GRANT DELETE, INSERT, SELECT, UPDATE ON TABLE ucmcmt.email_messages TO ivchevl;

GRANT DELETE, INSERT, SELECT, UPDATE ON TABLE ucmcmt.email_messages TO negisu6;

GRANT DELETE, INSERT, SELECT, UPDATE ON TABLE ucmcmt.email_messages TO nomusa1;

GRANT ALL ON TABLE ucmcmt.email_messages TO ucm_app;

GRANT DELETE, INSERT, SELECT, UPDATE ON TABLE ucmcmt.email_messages TO wuwe4gy;
-- Index: idx_created_date

-- DROP INDEX IF EXISTS ucmcmt.idx_created_date;

CREATE INDEX IF NOT EXISTS idx_created_date
    ON ucmcmt.email_messages USING btree
    (created_date ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: idx_email_message_status_id

-- DROP INDEX IF EXISTS ucmcmt.idx_email_message_status_id;

CREATE INDEX IF NOT EXISTS idx_email_message_status_id
    ON ucmcmt.email_messages USING btree
    (email_message_status_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: idx_email_messages_email_message_id

-- DROP INDEX IF EXISTS ucmcmt.idx_email_messages_email_message_id;

CREATE INDEX IF NOT EXISTS idx_email_messages_email_message_id
    ON ucmcmt.email_messages USING btree
    (email_message_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: idx_email_messages_email_message_status_id

-- DROP INDEX IF EXISTS ucmcmt.idx_email_messages_email_message_status_id;

CREATE INDEX IF NOT EXISTS idx_email_messages_email_message_status_id
    ON ucmcmt.email_messages USING btree
    (email_message_status_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: idx_email_messages_is_fiber

-- DROP INDEX IF EXISTS ucmcmt.idx_email_messages_is_fiber;

CREATE INDEX IF NOT EXISTS idx_email_messages_is_fiber
    ON ucmcmt.email_messages USING btree
    (is_fiber ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: idx_email_messages_subject_gin_idx

-- DROP INDEX IF EXISTS ucmcmt.idx_email_messages_subject_gin_idx;

CREATE INDEX IF NOT EXISTS idx_email_messages_subject_gin_idx
    ON ucmcmt.email_messages USING gin
    (lower(subject) COLLATE pg_catalog."default")
    TABLESPACE pg_default;
-- Index: idx_locked_by

-- DROP INDEX IF EXISTS ucmcmt.idx_locked_by;

CREATE INDEX IF NOT EXISTS idx_locked_by
    ON ucmcmt.email_messages USING btree
    (locked_by COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: idx_message_id

-- DROP INDEX IF EXISTS ucmcmt.idx_message_id;

CREATE INDEX IF NOT EXISTS idx_message_id
    ON ucmcmt.email_messages USING btree
    (message_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: idx_party_id

-- DROP INDEX IF EXISTS ucmcmt.idx_party_id;

CREATE INDEX IF NOT EXISTS idx_party_id
    ON ucmcmt.email_messages USING btree
    (party_id ASC NULLS LAST)
    TABLESPACE pg_default;
